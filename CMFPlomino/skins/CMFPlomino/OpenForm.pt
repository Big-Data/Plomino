<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
<body>

<metal:javascript_head fill-slot="javascript_head_slot">
	<tal:block tal:condition="python:here.hasDateTimeField()">
	    <script type="text/javascript"
	              charset="iso-8859-1"
	              tal:attributes="src string:$portal_url/jscalendar/calendar_stripped.js">
	    </script>
		<script type="text/javascript"
              charset="iso-8859-1"
              tal:attributes="src string:$portal_url/jscalendar/calendar-en.js">
      </script>
	</tal:block>
</metal:javascript_head>

<metal:css fill-slot="css_slot">
	<tal:block tal:condition="python:here.hasDateTimeField()">
      <style type="text/css"
             media="all"
             tal:content="structure string:<!-- @import url($portal_url/jscalendar/calendar-system.css); -->">
      </style>
	</tal:block>
</metal:css>

<metal:main fill-slot="main">
    <div id="bodyContent" tal:define="myF python:here;
							b myF/ActionBarPosition|nothing;
							searchform myF/isSearchForm|nothing">
		<tal:block tal:condition="python:not(searchform)">
		    <form tal:attributes="name here/id" action="createDocument" method="POST" enctype="multipart/form-data">
				<tal:block
					tal:define="owner python:myF"
					tal:condition= "python:test((b and  myF.ActionBarPosition=='BOTTOM'),False, True)"
					>
					<span metal:use-macro="here/ActionBar/macros/OpenFormActionBar" >
						display form actions
					</span>
				</tal:block>
				<span tal:content="structure python:here.formLayout()" />
				<tal:block
					tal:define="owner python:myF"
					tal:condition="python:test((b and myF.ActionBarPosition!='TOP'),True, False)"
					>
					<span metal:use-macro="here/ActionBar/macros/OpenFormActionBar" >
						display form actions
					</span>
				</tal:block>
			</form>
		</tal:block>
		<tal:block tal:condition="searchform">
		   <form tal:attributes="name here/id" action="searchDocuments" method="POST">
				<tal:block
					tal:define="owner python:myF"
					tal:condition= "python:test((b and  myF.ActionBarPosition=='BOTTOM'),False, True)"
					>
					<span metal:use-macro="here/ActionBar/macros/SearchFormActionBar" >
						display form actions
					</span>
				</tal:block>
				<span tal:content="structure python:here.formLayout(request)" />
				<tal:block
					tal:define="owner python:myF"
					tal:condition="python:test((b and myF.ActionBarPosition!='TOP'),True, False)"
					>
					<span metal:use-macro="here/ActionBar/macros/SearchFormActionBar" >
						display form actions
					</span>
				</tal:block>
			</form>
			
			<tal:results tal:define="anyresults python:options.has_key('searchresults');
									searchviewname python:here.getSearchView();
									searchviewobj python:here.getParentDatabase().getView(searchviewname);
									">
				<table tal:condition="anyresults" tal:define="columns python:searchviewobj.getColumns()"
	    			id="sortable"
	                class="listing"
	                summary="Content listing"
	                i18n:attributes="summary summary_content_listing;">
		            <tr>
		            <th>&nbsp;&nbsp;</th>
			            <tal:block tal:repeat="c columns">
			            	<th tal:condition="not: c/HiddenColumn|nothing">&nbsp;<span tal:content="c/Title">Title</span>&nbsp;</th>
			            </tal:block>
		            </tr>
	            	<tal:block tal:repeat="doc options/searchresults">
						<tr tal:define="oddrow repeat/doc/odd"
									tal:attributes="class python:test(oddrow, 'even', 'odd')"
									>
							<td><a href="#" tal:attributes="href python:doc.getPath().split('/')[-1]" i18n:domain="CMFPlomino" i18n:translate="go_link">Go</a></td>
							<tal:block tal:repeat="c columns">
								<td tal:condition="not: c/HiddenColumn|nothing"><span tal:define="cname c/id;
													vname searchviewobj/id;
													cvalue python:path('doc/PlominoViewColumn_%s_%s' % (vname, cname));
													"
											tal:content="structure cvalue" /></td>
							</tal:block>
						</tr>
					</tal:block>
				</table>
			</tal:results>
		</tal:block>
	</div>
</metal:main>

</body>
</html>
